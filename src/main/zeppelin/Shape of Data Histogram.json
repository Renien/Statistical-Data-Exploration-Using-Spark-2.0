{"paragraphs":[{"text":"//change path to match your system\nval filePath = \"/home/madhu/Dev/mybuild/data-exploration-spark-2.0/src/main/resources/LifeExpentancy.txt\"","dateUpdated":"2016-10-22T13:12:11+0530","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1477121633711_1827854602","id":"20161022-130353_824729095","result":{"code":"SUCCESS","type":"TEXT","msg":"\nfilePath: String = /home/madhu/Dev/mybuild/data-exploration-spark-2.0/src/main/resources/LifeExpentancy.txt\n"},"dateCreated":"2016-10-22T13:03:53+0530","dateStarted":"2016-10-22T13:12:11+0530","dateFinished":"2016-10-22T13:12:11+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1643"},{"text":"import org.apache.spark.sql.SparkSession\nval sparkSession = SparkSession.builder()                                       \n            .master(\"local\")                                                     \n            .appName(\"summary example\")                                         \n            .getOrCreate()","dateUpdated":"2016-10-22T13:12:11+0530","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1477119901543_-226437959","id":"20161022-123501_899769427","result":{"code":"SUCCESS","type":"TEXT","msg":"\nimport org.apache.spark.sql.SparkSession\n\nsparkSession: org.apache.spark.sql.SparkSession = org.apache.spark.sql.SparkSession@431b919d\n"},"dateCreated":"2016-10-22T12:35:01+0530","dateStarted":"2016-10-22T13:12:11+0530","dateFinished":"2016-10-22T13:12:12+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1644"},{"text":"import org.apache.spark.sql.types._\nval rawDF = sparkSession.read.format(\"csv\").option(\"delimiter\",\" \").\n   option(\"inferSchema\",\"true\").load(filePath)\n   //only extract the values we need\n   val schema = StructType(Array(\n           StructField(\"Country\",StringType),\n           StructField(\"LifeExp\",DoubleType),\n           StructField(\"Region\",StringType)\n   ))\n   val selectedDF = rawDF.select(\"_c0\",\"_c2\",\"_c4\")\n   val lifeExpectancyDF = sparkSession.createDataFrame(selectedDF.rdd,schema)\n   lifeExpectancyDF\n   lifeExpectancyDF.createOrReplaceTempView(\"lifeExpectancyDF\")\n","dateUpdated":"2016-10-22T13:12:11+0530","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1477119930689_-1242697722","id":"20161022-123530_1199932144","result":{"code":"SUCCESS","type":"TEXT","msg":"\nimport org.apache.spark.sql.types._\n\nrawDF: org.apache.spark.sql.DataFrame = [_c0: string, _c1: string ... 3 more fields]\n\nschema: org.apache.spark.sql.types.StructType = StructType(StructField(Country,StringType,true), StructField(LifeExp,DoubleType,true), StructField(Region,StringType,true))\n\nselectedDF: org.apache.spark.sql.DataFrame = [_c0: string, _c2: double ... 1 more field]\n\nlifeExpectancyDF: org.apache.spark.sql.DataFrame = [Country: string, LifeExp: double ... 1 more field]\n\nres72: org.apache.spark.sql.DataFrame = [Country: string, LifeExp: double ... 1 more field]\n"},"dateCreated":"2016-10-22T12:35:30+0530","dateStarted":"2016-10-22T13:12:12+0530","dateFinished":"2016-10-22T13:12:13+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1645"},{"text":"val (startValues,counts) = lifeExpectancyDF.select(\"LifeExp\").map(value => value.getDouble(0)).rdd.histogram(5)\nval zippedValues = startValues.zip(counts)\ncase class HistRow(startPoint:Double,count:Long)\nval rowRDD = zippedValues.map( value => HistRow(value._1,value._2))\nval histDf = sparkSession.createDataFrame(rowRDD)\nhistDf.createOrReplaceTempView(\"histogramTable\")","dateUpdated":"2016-10-22T13:12:11+0530","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1477120185874_-823738462","id":"20161022-123945_296124768","result":{"code":"SUCCESS","type":"TEXT","msg":"\n\nstartValues: Array[Double] = Array(47.794, 54.914, 62.034, 69.154, 76.274, 83.394)\ncounts: Array[Long] = Array(24, 18, 32, 69, 54)\n\nzippedValues: Array[(Double, Long)] = Array((47.794,24), (54.914,18), (62.034,32), (69.154,69), (76.274,54))\n\ndefined class HistRow\n\nrowRDD: Array[HistRow] = Array(HistRow(47.794,24), HistRow(54.914,18), HistRow(62.034,32), HistRow(69.154,69), HistRow(76.274,54))\n\nhistDf: org.apache.spark.sql.DataFrame = [startPoint: double, count: bigint]\n"},"dateCreated":"2016-10-22T12:39:45+0530","dateStarted":"2016-10-22T13:12:12+0530","dateFinished":"2016-10-22T13:12:13+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1646","focus":true},{"text":"%sql\nselect * from histogramTable","dateUpdated":"2016-10-22T13:12:29+0530","config":{"colWidth":12,"graph":{"mode":"multiBarChart","height":300,"optionOpen":true,"keys":[{"name":"startPoint","index":0,"aggr":"sum","$$hashKey":"object:2312"}],"values":[{"name":"count","index":1,"aggr":"sum","$$hashKey":"object:2315"}],"groups":[],"scatter":{"yAxis":{"name":"count","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1477120295456_-1125965563","id":"20161022-124135_153372855","result":{"code":"SUCCESS","type":"TABLE","msg":"startPoint\tcount\n47.794\t24\n54.914\t18\n62.034\t32\n69.154\t69\n76.274\t54\n","comment":"","msgTable":[[{"key":"count","value":"47.794"},{"key":"count","value":"24"}],[{"value":"54.914"},{"value":"18"}],[{"value":"62.034"},{"value":"32"}],[{"value":"69.154"},{"value":"69"}],[{"value":"76.274"},{"value":"54"}]],"columnNames":[{"name":"startPoint","index":0,"aggr":"sum","$$hashKey":"object:2306"},{"name":"count","index":1,"aggr":"sum","$$hashKey":"object:2307"}],"rows":[["47.794","24"],["54.914","18"],["62.034","32"],["69.154","69"],["76.274","54"]]},"dateCreated":"2016-10-22T12:41:35+0530","dateStarted":"2016-10-22T13:12:13+0530","dateFinished":"2016-10-22T13:12:13+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1647"},{"text":"","dateUpdated":"2016-10-22T13:12:11+0530","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1477120919514_-792729808","id":"20161022-125159_165342689","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"2016-10-22T12:51:59+0530","dateStarted":"2016-10-22T13:12:13+0530","dateFinished":"2016-10-22T13:12:13+0530","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1648"}],"name":"Shape of Data Histogram","id":"2C1X893S6","angularObjects":{"2C298N1VJ:shared_process":[],"2BYB7J28K:shared_process":[],"2C1ASSEUC:shared_process":[],"2C2MAD4B2:shared_process":[],"2BZYA1Q9V:shared_process":[],"2BY8RNAA4:shared_process":[],"2C2J1ZPRX:shared_process":[],"2C2N935BG:shared_process":[],"2BZ8DX77W:shared_process":[],"2BZEY4U9R:shared_process":[],"2BY5GRVB8:shared_process":[],"2C1G5FUCT:shared_process":[],"2C15AMECA:shared_process":[],"2C1ENX1CJ:shared_process":[],"2BXTKRJWA:shared_process":[],"2BZB8PNJS:shared_process":[],"2C2DWKSFC:shared_process":[],"2C13RETB4:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}